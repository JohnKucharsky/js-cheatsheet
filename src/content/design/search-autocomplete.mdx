
## search autocomplete

```js
class AutocompleteSystem {
  constructor(sentences, times) {
    this.trie = {};
    this.inputStr = "";
    this.currentNode = this.trie;

    for (let i = 0; i < sentences.length; i++) {
      this.addSentence(sentences[i], times[i]);
    }
  }

  addSentence(sentence, time) {
    let node = this.trie;
    for (let char of sentence) {
      if (!node[char]) {
        node[char] = { count: 0, children: {} };
      }
      node = node[char].children;
    }
    node["#"] = (node["#"] || 0) + time;
  }

  input(c) {
    if (c === "#") {
      this.addSentence(this.inputStr, 1);
      this.inputStr = "";
      this.currentNode = this.trie;
      return [];
    }

    this.inputStr += c;
    if (this.currentNode && this.currentNode[c]) {
      this.currentNode = this.currentNode[c].children;
    } else {
      this.currentNode = null;
    }

    return this.currentNode
      ? this.getTop3(this.currentNode, this.inputStr)
      : [];
  }

  getTop3(node, prefix) {
    const results = [];
    this.dfs(node, prefix, results);
    results.sort(
      (a, b) => b.count - a.count || a.sentence.localeCompare(b.sentence),
    );
    return results.slice(0, 3).map((result) => result.sentence);
  }

  dfs(node, prefix, results) {
    if (node["#"]) {
      results.push({ sentence: prefix, count: node["#"] });
    }
    for (let char in node) {
      if (char !== "#") {
        this.dfs(node[char].children, prefix + char, results);
      }
    }
  }
}

// Example usage:
const autocompleteSystem = new AutocompleteSystem(
  ["i love you", "island", "iroman", "i love leetcode"],
  [5, 3, 2, 2],
);
console.log(autocompleteSystem.input("i")); // Output: ["i love you", "island", "i love leetcode"]
console.log(autocompleteSystem.input(" ")); // Output: ["i love you", "i love leetcode"]
console.log(autocompleteSystem.input("a")); // Output: []
console.log(autocompleteSystem.input("#")); // Output: []
```
